import{r as l,j as e}from"./vendor-BKCITg7t.js";import{m as B,o as $,d as U,j as N,p as D,s as O}from"./utils-D_2V6O3E.js";import{T as I,W}from"./corrections-mbUiBgzB.js";const G=["standard","center","compact","toolbar","toolbarLarge","toggle","close","tab"],_=["slate","gray","zinc","neutral","stone","red","orange","amber","yellow","lime","green","emerald","teal","cyan","sky","blue","indigo","violet","purple","fuchsia","pink","rose"];function h({ariaLabel:s,onClick:t,disabled:c=!1,icon:r,label:n,highlightEntities:o,enableHighlightTap:i=!1,pressed:d=!1,size:x="md",title:v,type:f="button",variant:u="standard",preset:j,"data-action-name":g,"data-item-name":p,"data-option":m,"data-prompt-effect":w,"data-node-id":b}){const S=l.useCallback(z=>{t(z),z.currentTarget.blur()},[t]),L=u==="standard"||u==="center"||u==="compact"?{sm:"px-3 py-1 text-sm",md:"px-3 py-2 text-base",lg:"px-3 py-3 text-lg"}[x]:"",y={standard:"w-full flex items-center justify-center",center:"w-full flex items-center text-center",compact:"inline-flex items-center justify-center",toolbar:"flex items-center justify-center w-9 h-9 p-2",toolbarLarge:"flex items-center justify-center w-[4.33rem] h-[4.33rem] p-3",toggle:"inline-flex items-center justify-center px-3 py-1 text-xs",close:"animated-frame-close-button",tab:"px-3 py-2 text-sm font-medium transition-colors"},E={slate:"bg-slate-600 hover:bg-slate-500 focus:ring-slate-400",gray:"bg-gray-700 hover:bg-gray-500 focus:ring-gray-400",zinc:"bg-zinc-700 hover:bg-zinc-500 focus:ring-zinc-400",neutral:"bg-neutral-700 hover:bg-neutral-500 focus:ring-neutral-400",stone:"bg-stone-700 hover:bg-stone-500 focus:ring-stone-400",red:"bg-red-700 hover:bg-red-500 focus:ring-red-400",orange:"bg-orange-700 hover:bg-orange-500 focus:ring-orange-400",amber:"bg-amber-700 hover:bg-amber-500 focus:ring-amber-400",yellow:"bg-yellow-700 hover:bg-yellow-500 focus:ring-yellow-400",lime:"bg-lime-700 hover:bg-lime-500 focus:ring-lime-400",green:"bg-green-700 hover:bg-green-500 focus:ring-green-400",emerald:"bg-emerald-700 hover:bg-emerald-500 focus:ring-emerald-400",teal:"bg-teal-700 hover:bg-teal-500 focus:ring-teal-400",cyan:"bg-cyan-700 hover:bg-cyan-500 focus:ring-cyan-400",sky:"bg-sky-700 hover:bg-sky-500 focus:ring-sky-400",blue:"bg-blue-700 hover:bg-blue-500 focus:ring-blue-400",indigo:"bg-indigo-700 hover:bg-indigo-500 focus:ring-indigo-400",violet:"bg-violet-700 hover:bg-violet-500 focus:ring-violet-400",purple:"bg-purple-700 hover:bg-purple-500 focus:ring-purple-400",fuchsia:"bg-fuchsia-700 hover:bg-fuchsia-500 focus:ring-fuchsia-400",pink:"bg-pink-700 hover:bg-pink-500 focus:ring-pink-400",rose:"bg-rose-700 hover:bg-rose-500 focus:ring-rose-400"},V=u==="toggle"&&d?"ring-2 ring-sky-400 ring-offset-1 ring-offset-slate-800":u==="tab"?d?"border-b-2 border-sky-400 text-sky-300":"text-slate-300 hover:text-sky-400 border-b-2 border-transparent":"",A=o&&typeof n=="string"?B(n,o,i):n;return e.jsxs("button",{"aria-label":s,"aria-pressed":u==="toggle"?d:void 0,className:`rounded-md shadow transition-colors duration-150 focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 ${L} ${y[u]} ${j?E[j]:""} ${V}`,"data-action-name":g,"data-item-name":p,"data-node-id":b,"data-option":m,"data-prompt-effect":w,disabled:c,onClick:S,title:v,type:f==="submit"?"submit":f==="reset"?"reset":"button",children:[r?e.jsx("span",{className:n?"mr-2 inline-flex":"inline-flex",children:r}):null,A?e.jsx("span",{className:"flex-1 text-shadow-sm",children:A}):null]})}h.defaultProps={"data-action-name":void 0,"data-item-name":void 0,"data-node-id":void 0,"data-option":void 0,"data-prompt-effect":void 0,disabled:!1,enableHighlightTap:!1,highlightEntities:void 0,icon:void 0,label:void 0,preset:void 0,pressed:!1,size:"md",title:void 0,type:"button",variant:"standard"};function Q({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L1.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09zM18.25 12 17 13.75 15.75 12H13.5l1.25-1.25L16 9l1.25 1.75zM16 16.75l.813 2.846L15 18.75l-.813 2.846-.812-2.846-1.5.938L14.063 18l-1.188-1.5.938-1.5 1.188 1.5-1.188 1.5z",strokeLinecap:"round",strokeLinejoin:"round"})})}function X({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M14.25 7.756a4.5 4.5 0 1 0 0 8.488M7.5 10.5h5.25m-5.25 3h5.25M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0",strokeLinecap:"round",strokeLinejoin:"round"})})}function Z({height:s="1em",width:t="1em"}){return e.jsxs("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M2.036 12.322a1 1 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0",strokeLinecap:"round",strokeLinejoin:"round"})]})}function Y({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 6.042A8.97 8.97 0 0 0 6 3.75c-1.052 0-2.062.18-3 .512v14.25A9 9 0 0 1 6 18c2.305 0 4.408.867 6 2.292m0-14.25a8.97 8.97 0 0 1 6-2.292c1.052 0 2.062.18 3 .512v14.25A9 9 0 0 0 18 18a8.97 8.97 0 0 0-6-2.292m0 0V3.75m0 16.5V18",strokeLinecap:"round",strokeLinejoin:"round"})})}function K({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M3.75 6.75h16.5M3.75 12h16.5m-16.5 5.25h16.5",strokeLinecap:"round",strokeLinejoin:"round"})})}function P({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0m-9-3.75h.008v.008H12z",strokeLinecap:"round",strokeLinejoin:"round"})})}function ee({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9",strokeLinecap:"round",strokeLinejoin:"round"})})}function se({height:s="1em",width:t="1em"}){return e.jsxs("svg",{fill:"none",height:s,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M3 20V5l6-2v15zM9 18V3l6 2v15zM15 20V5l6 2v15z",stroke:"currentColor",strokeWidth:1.2}),e.jsx("path",{d:"M9 3v15M15 5v15",stroke:"#b6c2d1",strokeWidth:.8}),e.jsx("path",{d:"M3 20V5l6-2 6 2 6 2v15l-6-2-6-2-6 2",stroke:"currentColor",strokeWidth:1.2})]})}function te({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"currentColor",height:s,viewBox:"0 0 20 20",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M5 4a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2h2a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2zm0 4v10h10V8zm2-2h6V4H7z"})})}function ne({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21q.512.078 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48 48 0 0 0-3.478-.397m-12.56 0c1.153 0 2.243.032 3.223.094M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0",strokeLinecap:"round",strokeLinejoin:"round"})})}function ae({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M9 12h6m-6 4h6m2 5H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5.586a1 1 0 0 1 .707.293l5.414 5.414a1 1 0 0 1 .293.707V19a2 2 0 0 1-2 2",strokeLinecap:"round",strokeLinejoin:"round"})})}function re({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"currentColor",height:s,viewBox:"0 0 20 20",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{clipRule:"evenodd",d:"M10 9a3 3 0 1 0 0-6 3 3 0 0 0 0 6m-7 9a7 7 0 1 1 14 0z",fillRule:"evenodd"})})}function oe({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"currentColor",height:s,viewBox:"0 0 20 20",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M13 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0m5 2a2 2 0 1 1-4 0 2 2 0 0 1 4 0m-4 7a4 4 0 0 0-8 0v3h8zM6 8a2 2 0 1 1-4 0 2 2 0 0 1 4 0m10 10v-3a6 6 0 0 0-.75-2.906A3.005 3.005 0 0 1 19 15v3zM4.75 12.094A6 6 0 0 0 4 15v3H1v-3a3 3 0 0 1 3.75-2.906"})})}function le({height:s="1em",width:t="1em"}){return e.jsxs("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:2,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"m12 3 9 4.5-9 4.5-9-4.5z",fill:"#f8e7c0",strokeLinejoin:"round"}),e.jsx("path",{d:"m3 7.5 9 4.5v9l-9-4.5zM21 7.5 12 12v9l9-4.5z",fill:"#e2c48d",strokeLinejoin:"round"}),e.jsx("path",{d:"m12 3 9 4.5v9L12 21l-9-4.5v-9L12 3",strokeLinejoin:"round"})]})}function ie({height:s="1em",width:t="1em"}){return e.jsxs("svg",{fill:"none",height:s,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("circle",{cx:12,cy:12,r:10,stroke:"currentColor",strokeWidth:2}),e.jsx("circle",{cx:12,cy:12,fill:"currentColor",r:4}),e.jsx("g",{stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{d:"M12 12V2M12 12l8.142 5.071M12 12v10M12 12l-8.142 5.071"})})]})}function ce({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M6 18 18 6M6 6l12 12",strokeLinecap:"round",strokeLinejoin:"round"})})}function me({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 8v4l3 3m6-3a9 9 0 1 1-18 0 9 9 0 0 1 18 0",strokeLinecap:"round",strokeLinejoin:"round"})})}function he({height:s="1em",width:t="1em"}){return e.jsx("svg",{fill:"currentColor",height:s,viewBox:"0 0 20 20",width:t,xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{clipRule:"evenodd",d:"M18 10a8 8 0 1 1-16 0 8 8 0 0 1 16 0m-7 4a1 1 0 1 1-2 0 1 1 0 0 1 2 0m-1-9a1 1 0 0 0-1 1v4a1 1 0 1 0 2 0V6a1 1 0 0 0-1-1",fillRule:"evenodd"})})}function pe({height:s="1em",width:t="1em"}){return e.jsxs("svg",{fill:"none",height:s,stroke:"currentColor",strokeWidth:1.5,viewBox:"0 0 24 24",width:t,xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M16.862 3.487a1.125 1.125 0 0 1 1.591 1.591l-9 9a1.125 1.125 0 0 1-.433.266L6 15l.656-2.976a1.125 1.125 0 0 1 .266-.433l9-9Z",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("path",{d:"M19.5 10.5V18A2.25 2.25 0 0 1 17.25 20.25H6.75A2.25 2.25 0 0 1 4.5 18V6.75A2.25 2.25 0 0 1 6.75 4.5H14.25",strokeLinecap:"round",strokeLinejoin:"round"})]})}const H={realityShift:Q,coin:X,visualize:Z,bookOpen:Y,menu:K,info:P,scroll:ee,map:se,inventory:te,trash:ne,log:ae,companion:re,nearbyNpc:oe,mapItemBox:le,mapWheel:ie,clock:me,error:he,x:ce,journalPen:pe},de=Object.keys(H);function T({name:s,size:t,color:c,inline:r=!1,marginRight:n,wrapper:o="span"}){const i=H[s],x=[r?"inline-block":"",c?{slate:"text-slate-400",gray:"text-gray-400",zinc:"text-zinc-400",neutral:"text-neutral-400",stone:"text-stone-400",red:"text-red-400",orange:"text-orange-400",amber:"text-amber-400",yellow:"text-yellow-400",lime:"text-lime-400",green:"text-green-400",emerald:"text-emerald-400",teal:"text-teal-400",cyan:"text-cyan-400",sky:"text-sky-400",blue:"text-blue-400",indigo:"text-indigo-400",violet:"text-violet-400",purple:"text-purple-400",fuchsia:"text-fuchsia-400",pink:"text-pink-400",rose:"text-rose-400",white:"text-white"}[c]:""].filter(Boolean).join(" "),v=n?{marginRight:n}:void 0;return o==="g"?e.jsx("g",{className:x,style:v,children:e.jsx(i,{height:t,width:t})}):e.jsx("span",{className:x,style:v,children:e.jsx(i,{height:t,width:t})})}T.defaultProps={color:void 0,inline:!1,marginRight:void 0,size:void 0,wrapper:"span"};function a({title:s,content:t,isJson:c=!0,maxHeightClass:r="overflow-auto max-h-60"}){const n=(()=>{if(t==null)return"N/A";if(typeof t=="string")return t;if(c)try{const o=$(t);if(s.toLowerCase().includes("parsed")){const i=d=>{d&&typeof d=="object"&&(delete d.observations,delete d.rationale,Object.values(d).forEach(i))};i(o)}return JSON.stringify(o,null,2)}catch(o){return console.error("Error stringifying debug content:",o,t),"Error stringifying JSON content."}return typeof t=="string"?t:JSON.stringify(t,null,2)})();return e.jsxs("section",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-sky-400 mb-1",children:s}),e.jsx("pre",{className:`bg-slate-900 p-2 rounded-md text-sm  font-mono text-white overflow-auto ${r} whitespace-pre-wrap break-words`,children:e.jsx("code",{children:n})})]})}a.defaultProps={isJson:!0,maxHeightClass:"overflow-auto max-h-60"};function ge({npcs:s}){return e.jsx(a,{content:s,maxHeightClass:"max-h-[70vh]",title:"Current NPCs"})}const C=s=>{try{return JSON.parse(`"${s.replace(/"/g,'\\"')}"`)}catch{return s.replace(/\\n/g,`
`)}},R=s=>{if(!s)return"";const t=U(s);try{const c=JSON.parse(t),r=n=>{n&&typeof n=="object"&&(delete n.observations,delete n.rationale,Object.values(n).forEach(r))};return r(c),JSON.stringify(c,null,2)}catch{return s.replace(/"?(observations|rationale)"?\s*:\s*"[^"\\]*(?:\\.[^"\\]*)*"\s*,?/gi,"").trim()}};function ue({debugPacket:s}){const[t,c]=l.useState("reqres"),r=l.useCallback(()=>{c("reqres")},[]),n=l.useCallback(()=>{c("insights")},[]),o=l.useCallback(()=>{c("prompt")},[]);return s!=null&&s.dialogueDebugInfo?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show request and response",label:"Req/Res",onClick:r,preset:t==="reqres"?"sky":"slate",pressed:t==="reqres",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show insights",label:"Insights",onClick:n,preset:t==="insights"?"sky":"slate",pressed:t==="insights",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show system prompt",label:"Prompt",onClick:o,preset:t==="prompt"?"sky":"slate",pressed:t==="prompt",size:"sm",variant:"toggle"})]}),t==="reqres"?e.jsx(e.Fragment,{children:s.dialogueDebugInfo.turns.map((i,d)=>{const x=i.thoughts&&i.thoughts.length>0?i.thoughts.map(f=>`Narrator THOUGHTS: "${C(f)}"`).join(`
`):null,v=x?`${x}
${i.rawResponse}`:i.rawResponse;return e.jsxs("div",{className:"mb-2",children:[e.jsx(a,{content:i.prompt,isJson:!1,title:`Turn ${String(d+1)} Request`}),e.jsx(a,{content:v,isJson:!1,title:`Turn ${String(d+1)} Response`})]},i.prompt)})}):t==="insights"?e.jsxs(e.Fragment,{children:[s.dialogueDebugInfo.summaryThoughts&&s.dialogueDebugInfo.summaryThoughts.length>0?e.jsx(a,{content:s.dialogueDebugInfo.summaryThoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Dialogue Summary Thoughts"}):null,s.dialogueDebugInfo.summaryPrompt?e.jsx(a,{content:s.dialogueDebugInfo.summaryPrompt,isJson:!1,title:"Dialogue Summary Prompt"}):null,s.dialogueDebugInfo.summaryRawResponse?e.jsx(a,{content:s.dialogueDebugInfo.summaryRawResponse,isJson:!1,title:"Dialogue Summary Response"}):null]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.dialogueDebugInfo.systemInstruction??"N/A",isJson:!1,title:"System Prompt"}),s.dialogueDebugInfo.jsonSchema?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.dialogueDebugInfo.jsonSchema,title:"Raw Schema"}),e.jsx(a,{content:N(s.dialogueDebugInfo.jsonSchema),isJson:!1,title:"Schema as Prompt"})]}):null]})]}):e.jsx("p",{className:"italic text-slate-300",children:"No Dialogue debug info captured."})}function xe({gameLog:s}){return e.jsx(a,{content:s,maxHeightClass:"max-h-[70vh]",title:"Current Game Log"})}function q({currentState:s,onUndoTurn:t,onApplyGameState:c,previousState:r=void 0}){const[n,o]=l.useState(""),[i,d]=l.useState(null);l.useEffect(()=>{const f=D(s);delete f.lastDebugPacket,o(JSON.stringify(f,null,2))},[s]);const x=l.useCallback(f=>{o(f.target.value),d(null)},[]),v=l.useCallback(()=>{const f=O(n);if(f){const u=$(f);u.inventory=u.inventory.map(j=>{var p;const g=s.inventory.find(m=>m.id===j.id);return g?{...j,chapters:(p=j.chapters)==null?void 0:p.map((m,w)=>{var b,S;return{...m,imageData:(S=(b=g.chapters)==null?void 0:b[w])==null?void 0:S.imageData}})}:j}),u.playerJournal=u.playerJournal.map((j,g)=>{var p;return{...j,imageData:(p=s.playerJournal[g])==null?void 0:p.imageData}}),c(u),d(null)}else d("Invalid JSON")},[n,c,s]);return e.jsxs(e.Fragment,{children:[e.jsx(h,{ariaLabel:"Undo last turn",disabled:!r||s.globalTurnNumber<=1,label:`Undo Turn (Global Turn: ${String(s.globalTurnNumber)})`,onClick:t,preset:"orange",size:"sm",variant:"compact"}),e.jsxs("div",{className:"my-2",children:[e.jsx("label",{className:"block text-sm text-amber-300 mb-1",htmlFor:"gameStateEdit",children:"Edit Game State"}),e.jsx("textarea",{className:"w-full p-2 bg-slate-900 text-white border border-slate-600 rounded-md text-sm min-h-[40em] font-mono",id:"gameStateEdit",onChange:x,value:n}),e.jsx(h,{ariaLabel:"Verify and apply edited game state",label:"Verify & Apply",onClick:v,preset:"green",size:"sm",variant:"compact"}),i?e.jsx("p",{className:"text-red-400 text-xs mt-1",children:i}):null]}),e.jsx(a,{content:D(s),maxHeightClass:"max-h-[30vh]",title:"Current Game State (Stack[0] - Top)"}),r?e.jsx(a,{content:(()=>{const f=D(r);return delete f.lastDebugPacket,f})(),maxHeightClass:"max-h-[30vh]",title:"Previous Game State (Stack[1] - Bottom)"}):null]})}q.defaultProps={previousState:void 0};function ve({debugPacket:s}){const[t,c]=l.useState(!0),[r,n]=l.useState("reqres"),o=l.useCallback(()=>{c(!0)},[]),i=l.useCallback(()=>{c(!1)},[]),d=l.useCallback(()=>{n("reqres")},[]),x=l.useCallback(()=>{n("insights")},[]),v=l.useCallback(()=>{n("prompt")},[]);return s!=null&&s.inventoryDebugInfo?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show request and response",label:"Req/Res",onClick:d,preset:r==="reqres"?"sky":"slate",pressed:r==="reqres",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show insights",label:"Insights",onClick:x,preset:r==="insights"?"sky":"slate",pressed:r==="insights",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show system prompt",label:"Prompt",onClick:v,preset:r==="prompt"?"sky":"slate",pressed:r==="prompt",size:"sm",variant:"toggle"})]}),r==="reqres"?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.inventoryDebugInfo.prompt,isJson:!1,title:"Inventory AI Request"}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show raw inventory response",label:"Raw",onClick:o,preset:t?"sky":"slate",pressed:t,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show parsed inventory response",label:"Parsed",onClick:i,preset:t?"slate":"sky",pressed:!t,size:"sm",variant:"toggle"})]}),t?e.jsx(a,{content:R(s.inventoryDebugInfo.rawResponse),isJson:!1,title:"Inventory AI Response Raw"}):e.jsx(a,{content:s.inventoryDebugInfo.parsedItemChanges,title:"Inventory AI Response Parsed"})]}):r==="insights"?e.jsxs(e.Fragment,{children:[s.inventoryDebugInfo.thoughts&&s.inventoryDebugInfo.thoughts.length>0?e.jsx(a,{content:s.inventoryDebugInfo.thoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Inventory Thoughts"}):null,s.inventoryDebugInfo.observations?e.jsx(a,{content:s.inventoryDebugInfo.observations,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Inventory Observations"}):null,s.inventoryDebugInfo.rationale?e.jsx(a,{content:s.inventoryDebugInfo.rationale,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Inventory Rationale"}):null]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.inventoryDebugInfo.systemInstruction??"N/A",isJson:!1,title:"System Prompt"}),s.inventoryDebugInfo.jsonSchema?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.inventoryDebugInfo.jsonSchema,title:"Raw Schema"}),e.jsx(a,{content:N(s.inventoryDebugInfo.jsonSchema),isJson:!1,title:"Schema as Prompt"})]}):null]})]}):e.jsx("p",{className:"italic text-slate-300",children:"No Inventory AI interaction debug packet captured."})}function fe({inventory:s}){return e.jsx(a,{content:s,maxHeightClass:"max-h-[70vh]",title:"Current Inventory"})}function je({debugPacket:s}){const[t,c]=l.useState(!0),[r,n]=l.useState("reqres"),o=l.useCallback(()=>{c(!0)},[]),i=l.useCallback(()=>{c(!1)},[]),d=l.useCallback(()=>{n("reqres")},[]),x=l.useCallback(()=>{n("insights")},[]),v=l.useCallback(()=>{n("prompt")},[]),f=s!=null&&s.timestamp?new Date(s.timestamp).toLocaleString():"N/A";return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-slate-300 mb-2",children:["Timestamp:",f]}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show request and response",label:"Req/Res",onClick:d,preset:r==="reqres"?"sky":"slate",pressed:r==="reqres",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show insights",label:"Insights",onClick:x,preset:r==="insights"?"sky":"slate",pressed:r==="insights",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show system prompt",label:"Prompt",onClick:v,preset:r==="prompt"?"sky":"slate",pressed:r==="prompt",size:"sm",variant:"toggle"})]}),r==="reqres"?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s==null?void 0:s.prompt,isJson:!1,title:"Last Storyteller AI Request"}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show raw response",label:"Raw",onClick:o,preset:t?"sky":"slate",pressed:t,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show parsed response",label:"Parsed",onClick:i,preset:t?"slate":"sky",pressed:!t,size:"sm",variant:"toggle"})]}),t?e.jsx(a,{content:s==null?void 0:s.rawResponseText,isJson:!1,title:"Storyteller AI Response Raw"}):e.jsx(a,{content:s==null?void 0:s.parsedResponse,title:"Storyteller AI Response Parsed "})]}):r==="insights"?s!=null&&s.storytellerThoughts&&s.storytellerThoughts.length>0?e.jsx(a,{content:s.storytellerThoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Storyteller Thoughts"}):null:e.jsxs(e.Fragment,{children:[e.jsx(a,{content:(s==null?void 0:s.systemInstruction)??"N/A",isJson:!1,title:"System Prompt"}),s!=null&&s.jsonSchema?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.jsonSchema,title:"Raw Schema"}),e.jsx(a,{content:N(s.jsonSchema),isJson:!1,title:"Schema as Prompt"})]}):null]}),s!=null&&s.error?e.jsx(a,{content:s.error,isJson:!1,title:"Error During Storyteller AI Interaction"}):null]})}function we({mapData:s}){return e.jsx(a,{content:s,maxHeightClass:"max-h-[70vh]",title:"Current Map Data (Full)"})}function be({themeFacts:s}){const t=[...s].sort((c,r)=>r.tier-c.tier||r.createdTurn-c.createdTurn).map((c,r)=>`${String(r+1)}. (Tier ${String(c.tier)}) ${c.text}`).join(`
`);return e.jsx(a,{content:t,isJson:!1,maxHeightClass:"max-h-[70vh]",title:"Current Theme Lore"})}function ye({debugPacket:s}){const[t,c]=l.useState(!0),[r,n]=l.useState({}),[o,i]=l.useState("reqres"),d=l.useCallback(()=>{c(!0)},[]),x=l.useCallback(()=>{c(!1)},[]),v=l.useCallback(()=>{i("reqres")},[]),f=l.useCallback(()=>{i("insights")},[]),u=l.useCallback(()=>{i("prompt")},[]),j=l.useCallback(m=>()=>{n(w=>({...w,[m]:!0}))},[]),g=l.useCallback(m=>()=>{n(w=>({...w,[m]:!1}))},[]),p=s!=null&&s.timestamp?new Date(s.timestamp).toLocaleString():"N/A";return e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-sm text-slate-300 mb-2",children:["Map Update related to interaction at:",p]}),s!=null&&s.mapUpdateDebugInfo?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show request and response",label:"Req/Res",onClick:v,preset:o==="reqres"?"sky":"slate",pressed:o==="reqres",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show insights",label:"Insights",onClick:f,preset:o==="insights"?"sky":"slate",pressed:o==="insights",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show system prompt",label:"Prompt",onClick:u,preset:o==="prompt"?"sky":"slate",pressed:o==="prompt",size:"sm",variant:"toggle"})]}),o==="reqres"?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.mapUpdateDebugInfo.prompt,isJson:!1,title:"Cartographer AI Request"}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show raw map response",label:"Raw",onClick:d,preset:t?"sky":"slate",pressed:t,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show parsed map response",label:"Parsed",onClick:x,preset:t?"slate":"sky",pressed:!t,size:"sm",variant:"toggle"})]}),t?e.jsx(a,{content:R(s.mapUpdateDebugInfo.rawResponse),isJson:!1,title:"Cartographer AI Response Raw"}):e.jsx(a,{content:s.mapUpdateDebugInfo.parsedPayload,title:"Cartographer AI Response Parsed"})]}):o==="insights"?e.jsxs(e.Fragment,{children:[s.mapUpdateDebugInfo.thoughts&&s.mapUpdateDebugInfo.thoughts.length>0?e.jsx(a,{content:s.mapUpdateDebugInfo.thoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Cartographer Thoughts"}):null,s.mapUpdateDebugInfo.observations?e.jsx(a,{content:s.mapUpdateDebugInfo.observations,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Cartographer Observations"}):null,s.mapUpdateDebugInfo.rationale?e.jsx(a,{content:s.mapUpdateDebugInfo.rationale,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:"Cartographer Rationale"}):null]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.mapUpdateDebugInfo.systemInstruction??"N/A",isJson:!1,title:"System Prompt"}),s.mapUpdateDebugInfo.jsonSchema?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:s.mapUpdateDebugInfo.jsonSchema,title:"Raw Schema"}),e.jsx(a,{content:N(s.mapUpdateDebugInfo.jsonSchema),isJson:!1,title:"Schema as Prompt"})]}):null]}),s.mapUpdateDebugInfo.validationError?e.jsx(a,{content:s.mapUpdateDebugInfo.validationError,isJson:!1,title:"Map Update Validation Error"}):null,s.mapUpdateDebugInfo.minimalModelCalls?e.jsx(a,{content:s.mapUpdateDebugInfo.minimalModelCalls,title:"Minimal Model Calls"}):null,s.mapUpdateDebugInfo.connectorChainsDebugInfo&&s.mapUpdateDebugInfo.connectorChainsDebugInfo.length>0?s.mapUpdateDebugInfo.connectorChainsDebugInfo.map((m,w)=>e.jsxs("div",{className:"my-2",children:[o==="reqres"?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:m.prompt,isJson:!1,title:`Connector Chains Prompt (Round ${String(m.round)})`}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show raw connector chain response",label:"Raw",onClick:j(w),preset:r[w]??!0?"sky":"slate",pressed:r[w]??!0,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show parsed connector chain response",label:"Parsed",onClick:g(w),preset:r[w]??!0?"slate":"sky",pressed:!(r[w]??!0),size:"sm",variant:"toggle"})]}),r[w]??!0?m.rawResponse&&e.jsx(a,{content:R(m.rawResponse),isJson:!1,title:`Connector Chains Raw Response (Round ${String(m.round)})`}):m.parsedPayload&&e.jsx(a,{content:m.parsedPayload,title:`Connector Chains Parsed Payload (Round ${String(m.round)})`})]}):o==="insights"?e.jsxs(e.Fragment,{children:[m.thoughts&&m.thoughts.length>0?e.jsx(a,{content:m.thoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`Connector Chains Thoughts (Round ${String(m.round)})`}):null,m.observations?e.jsx(a,{content:m.observations,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`Connector Chains Observations (Round ${String(m.round)})`}):null,m.rationale?e.jsx(a,{content:m.rationale,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`Connector Chains Rationale (Round ${String(m.round)})`}):null]}):null,m.validationError?e.jsx(a,{content:m.validationError,isJson:!1,title:`Connector Chains Validation Error (Round ${String(m.round)})`}):null]},`chain-${String(m.round)}`)):null]}):e.jsx("p",{className:"italic text-slate-300",children:"No Map Update AI interaction debug packet captured for the last main AI turn."})]})}function Ce({debugPacket:s,onDistillFacts:t}){const[c,r]=l.useState({}),[n,o]=l.useState("reqres"),i=l.useCallback(g=>()=>{r(p=>({...p,[g]:!0}))},[]),d=l.useCallback(g=>()=>{r(p=>({...p,[g]:!1}))},[]),x=l.useCallback(()=>{o("reqres")},[]),v=l.useCallback(()=>{o("insights")},[]),f=l.useCallback(()=>{o("prompt")},[]),u=(g,p)=>{if(!p)return null;const m=c[g]??!0;return e.jsx("div",{className:"mb-4",children:n==="reqres"?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:p.prompt,isJson:!1,title:`${g} Request`}),e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:`Show raw ${g} response`,label:"Raw",onClick:i(g),preset:m?"sky":"slate",pressed:m,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:`Show parsed ${g} response`,label:"Parsed",onClick:d(g),preset:m?"slate":"sky",pressed:!m,size:"sm",variant:"toggle"})]}),m?e.jsx(a,{content:R(p.rawResponse),isJson:!1,title:`${g} Response Raw`}):e.jsx(a,{content:p.parsedPayload,title:`${g} Response Parsed`})]}):n==="insights"?e.jsxs(e.Fragment,{children:[p.thoughts&&p.thoughts.length>0?e.jsx(a,{content:p.thoughts.map(C).join(`
`),isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`${g} Thoughts`}):null,p.observations?e.jsx(a,{content:p.observations,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`${g} Observations`}):null,p.rationale?e.jsx(a,{content:p.rationale,isJson:!1,maxHeightClass:"overflow-visible max-h-fit",title:`${g} Rationale`}):null]}):e.jsxs(e.Fragment,{children:[e.jsx(a,{content:p.systemInstruction??"N/A",isJson:!1,title:`${g} System Prompt`}),p.jsonSchema?e.jsxs(e.Fragment,{children:[e.jsx(a,{content:p.jsonSchema,title:"Raw Schema"}),e.jsx(a,{content:N(p.jsonSchema),isJson:!1,title:"Schema as Prompt"})]}):null]})},g)},j=s==null?void 0:s.loremasterDebugInfo;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"my-2 flex flex-wrap gap-2",children:[e.jsx(h,{ariaLabel:"Show request and response",label:"Req/Res",onClick:x,preset:n==="reqres"?"sky":"slate",pressed:n==="reqres",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show insights",label:"Insights",onClick:v,preset:n==="insights"?"sky":"slate",pressed:n==="insights",size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"Show system prompt",label:"Prompt",onClick:f,preset:n==="prompt"?"sky":"slate",pressed:n==="prompt",size:"sm",variant:"toggle"})]}),e.jsx(h,{ariaLabel:"Trigger distill mode",label:"Run Distill",onClick:t,preset:"purple",size:"sm",variant:"compact"}),j?e.jsxs(e.Fragment,{children:[u("Collect",j.collect),u("Extract",j.extract),u("Integrate",j.integrate),u("Distill",j.distill),u("Journal",j.journal)]}):e.jsx("p",{className:"italic text-slate-300",children:"No Loremaster AI interaction debug packet captured."})]})}function Se({currentState:s}){return e.jsx(a,{content:{currentMapNodeId:s.currentMapNodeId,currentObjective:s.currentObjective,currentThemeName:s.currentThemeName,globalTurnNumber:s.globalTurnNumber,isAwaitingManualShiftThemeSelection:s.isAwaitingManualShiftThemeSelection,isCustomGameMode:s.isCustomGameMode,lastTurnChangesBrief:s.lastTurnChanges?{npcs:s.lastTurnChanges.npcChanges.length,items:s.lastTurnChanges.itemChanges.length,mapChanged:s.lastTurnChanges.mapDataChanged,objAchieved:s.lastTurnChanges.objectiveAchieved}:null,localEnvironment:s.localEnvironment,localPlace:s.localPlace,localTime:s.localTime,mainQuest:s.mainQuest,objectiveAnimationType:s.objectiveAnimationType,pendingNewThemeNameAfterShift:s.pendingNewThemeNameAfterShift,score:s.score,turnsSinceLastShift:s.turnsSinceLastShift},maxHeightClass:"max-h-[70vh]",title:"Miscellaneous State Values"})}function Ie({themeHistory:s}){return e.jsx(a,{content:s,maxHeightClass:"max-h-[70vh]",title:"Current Theme History"})}function F({mapData:s,travelPath:t}){if(!t||t.length===0)return e.jsx("p",{className:"italic text-slate-300",children:"No destination set."});const c=t.map(r=>{if(r.step==="node")return{step:"node",data:s.nodes.find(i=>i.id===r.id)??{id:r.id,missing:!0}};if(r.id.startsWith("hierarchy:")){const[o,i]=r.id.split(":")[1].split("->");return{step:"hierarchy",from:o,to:i}}return{step:"edge",data:s.edges.find(o=>o.id===r.id)??{id:r.id,missing:!0}}});return e.jsxs(e.Fragment,{children:[e.jsx(a,{content:t,title:"Travel Path (IDs)"}),e.jsx(a,{content:c,maxHeightClass:"max-h-[70vh]",title:"Expanded Path Data"})]})}F.defaultProps={travelPath:null};const k=[..._],Ne=[...G],Te=[...de],J=W.filter(s=>!I.includes(s)&&s!=="glitching");function Re(){const[s,t]=l.useState(new Set),c=l.useCallback(n=>()=>{t(o=>{const i=new Set(o);return i.has(n)?i.delete(n):i.add(n),i})},[]),r=l.useCallback(()=>{},[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg text-slate-300 mb-2",children:"Buttons"}),Ne.map(n=>{const o=n==="toggle",i=n==="close",d=i?k.slice(0,1):k;return e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"text-slate-400 mb-1",children:n}),e.jsx("div",{className:`flex flex-wrap gap-1${i?" relative h-12":""}`,children:d.map(x=>{const v=`${String(n)}-${String(x)}`;return e.jsx(h,{ariaLabel:v,icon:i?e.jsx(T,{name:"x",size:16}):void 0,label:i?void 0:x,onClick:o?c(v):r,preset:x,pressed:o?s.has(v):void 0,size:"sm",variant:n},v)})})]},n)})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg text-slate-300 mb-2",children:"Text Fields"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:k.slice(0,8).map(n=>e.jsx("input",{"aria-label":n,className:`p-2 rounded-md bg-${String(n)}-700 text-${String(n)}-200 border border-${String(n)}-500`,placeholder:n,readOnly:!0},n))})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg text-slate-300 mb-2",children:"Page Blocks"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-3",children:[I.map(n=>e.jsx("div",{className:`p-3 tag-${String(n)} rounded-md`,children:n},n)),I.flatMap(n=>J.map(o=>e.jsx("div",{className:`p-3 tag-${String(n)} tag-${String(o)} rounded-md`,children:`${n} ${o}`},`${n}-${o}`)))]}),e.jsxs("div",{className:"space-y-3",children:[I.map(n=>e.jsx("div",{className:`p-3 tag-${String(n)} tag-recovered rounded-md`,children:`${n} recovered`},`${n}-recovered`)),I.flatMap(n=>J.map(o=>e.jsx("div",{className:`p-3 tag-${String(n)} tag-${String(o)} tag-recovered rounded-md`,children:`${n} ${o} recovered`},`${n}-${o}-recovered`)))]})]})]}),e.jsxs("section",{children:[e.jsx("h3",{className:"text-lg text-slate-300 mb-2",children:"Icons"}),e.jsx("div",{className:"flex flex-wrap gap-3",children:Te.map(n=>e.jsxs("div",{className:"flex flex-col items-center text-slate-300",children:[e.jsx(T,{name:n,size:32}),e.jsx("span",{className:"text-xs mt-1",children:n})]},n))})]})]})}function Le({debugLore:s,onToggleDebugLore:t,goodFacts:c,badFacts:r,onSaveFacts:n,onClearFacts:o}){const[i,d]=l.useState(!1),x=l.useCallback(()=>{d(u=>!u)},[]),v=l.useCallback(()=>{const u=JSON.stringify({goodFacts:c,badFacts:r},null,2);n(u)},[c,r,n]),f=l.useCallback(()=>{o()},[o]);return e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-sky-300 mb-2",children:"Debug Lore"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx(h,{ariaLabel:"Toggle Debug Lore",label:s?"Disable":"Enable",onClick:t,preset:"purple",pressed:s,size:"sm",variant:"toggle"}),e.jsx(h,{ariaLabel:"View collected facts",label:i?"Hide Facts":"View Facts",onClick:x,preset:"sky",size:"sm",variant:"compact"}),i?e.jsx(h,{ariaLabel:"Save facts to file",label:"Save JSON",onClick:v,preset:"green",size:"sm",variant:"compact"}):null,i?e.jsx(h,{ariaLabel:"Clear collected facts",label:"Clear Facts",onClick:f,preset:"red",size:"sm",variant:"compact"}):null]}),i?e.jsx(a,{content:{goodFacts:c,badFacts:r},title:"Collected Facts"}):null]})}function Ae({isVisible:s,onClose:t,debugPacket:c,gameStateStack:r,onUndoTurn:n,onApplyGameState:o,travelPath:i,onDistillFacts:d,debugLore:x,onToggleDebugLore:v,goodFacts:f,badFacts:u,onSaveFacts:j,onClearFacts:g}){const[p,m]=l.useState("GameState"),w=l.useCallback(y=>()=>{m(y)},[]);if(!s)return null;const b=r[0],S=r[1],M=[{name:"GameState",label:"Game State"},{name:"MainAI",label:"Storyteller AI"},{name:"MapLocationAI",label:"Cartographer AI"},{name:"InventoryAI",label:"Inventory AI"},{name:"LoremasterAI",label:"Loremaster AI"},{name:"DialogueAI",label:"Dialogue AI"},{name:"Inventory",label:"Inventory"},{name:"NPCs",label:"NPCs"},{name:"MapDataFull",label:"Map Data"},{name:"Lore",label:"Lore"},{name:"ThemeHistory",label:"Theme History"},{name:"GameLog",label:"Game Log"},{name:"TravelPath",label:"Travel Path"},{name:"MiscState",label:"Misc State"},{name:"Playground",label:"Playground"},{name:"Settings",label:"Settings"}],L=()=>{switch(p){case"GameState":return e.jsx(q,{currentState:b,onApplyGameState:o,onUndoTurn:n,previousState:S});case"MainAI":return e.jsx(je,{debugPacket:c});case"MapLocationAI":return e.jsx(ye,{debugPacket:c});case"InventoryAI":return e.jsx(ve,{debugPacket:c});case"LoremasterAI":return e.jsx(Ce,{debugPacket:c,onDistillFacts:d});case"DialogueAI":return e.jsx(ue,{debugPacket:c});case"Inventory":return e.jsx(fe,{inventory:b.inventory});case"NPCs":return e.jsx(ge,{npcs:b.allNPCs});case"MapDataFull":return e.jsx(we,{mapData:b.mapData});case"Lore":return e.jsx(be,{themeFacts:b.themeFacts.filter(y=>y.themeName===b.currentThemeName)});case"ThemeHistory":return e.jsx(Ie,{themeHistory:b.themeHistory});case"GameLog":return e.jsx(xe,{gameLog:b.gameLog});case"TravelPath":return e.jsx(F,{mapData:b.mapData,travelPath:i});case"MiscState":return e.jsx(Se,{currentState:b});case"Playground":return e.jsx(Re,{});case"Settings":return e.jsx(Le,{badFacts:u,debugLore:x,goodFacts:f,onClearFacts:g,onSaveFacts:j,onToggleDebugLore:v});default:return e.jsx("p",{children:"Select a tab"})}};return e.jsx("div",{"aria-labelledby":"debug-view-title","aria-modal":"true",className:"animated-frame open",role:"dialog",children:e.jsxs("div",{className:"animated-frame-content flex flex-col",children:[e.jsx(h,{ariaLabel:"Close debug view",icon:e.jsx(T,{name:"x",size:20}),onClick:t,size:"sm",variant:"close"}),e.jsx("h1",{className:"text-2xl font-bold text-amber-400 mb-3 text-center flex-shrink-0",id:"debug-view-title",children:"Debug View & Game Internals"}),e.jsx("div",{className:"flex flex-wrap border-b border-slate-700 mb-3 flex-shrink-0",children:M.map(y=>e.jsx(h,{ariaLabel:y.label,label:y.label,onClick:w(y.name),pressed:p===y.name,size:"sm",variant:"tab"},y.name))}),e.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:L()})]})})}export{h as B,Ae as D,T as I};
